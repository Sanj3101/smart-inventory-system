<div class="products-container">
  <!-- Header -->
  <div class="page-header">
    <div>
      <h1>Products</h1>
      <p class="subtitle">Browse and add products to your cart</p>
    </div>

    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Search</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Name, category, price" />
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
  </div>

  <mat-divider></mat-divider>

  <!-- DESKTOP TABLE -->
  <div class="desktop-only">
    <div class="table-wrapper">
      <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z2 desktop-table">
        <!-- Name -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Product</th>
          <td mat-cell *matCellDef="let p">
            {{ p.name | titlecase }}
          </td>
        </ng-container>

        <!-- Category -->
        <ng-container matColumnDef="category">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Category</th>
          <td mat-cell *matCellDef="let p">
            {{ p.category | titlecase }}
          </td>
        </ng-container>

        <!-- Price -->
        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Price</th>
          <td mat-cell *matCellDef="let p">
            {{ p.price | currency : 'INR' : 'symbol' }}
          </td>
        </ng-container>

        <!-- Quantity -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef>Qty</th>
          <td mat-cell *matCellDef="let p">
            <div class="qty-control">
              <button mat-icon-button (click)="decreaseQty(p.id)">
                <mat-icon>remove</mat-icon>
              </button>

              <span>{{ quantities[p.id] }}</span>

              <button mat-icon-button (click)="increaseQty(p.id)">
                <mat-icon>add</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <!-- Actions -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let p">
            <button mat-flat-button color="primary" (click)="addToCart(p)">Add</button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
      <mat-paginator
        [pageSize]="5"
        [pageSizeOptions]="[5, 10, 20]"
        showFirstLastButtons
      ></mat-paginator>
    </div>
  </div>

  <!-- MOBILE CARDS -->
  <div class="mobile-only">
    <div class="product-card" *ngFor="let p of dataSource.data">
      <div class="card-header">
        <strong>{{ p.name | titlecase }}</strong>
        <span class="price">
          {{ p.price | currency : 'INR' : 'symbol' }}
        </span>
      </div>

      <div class="card-row">
        <span>Category</span>
        <span>{{ p.category | titlecase }}</span>
      </div>

      <div class="card-row qty-row">
        <span>Quantity</span>
        <div class="qty-control">
          <button mat-icon-button (click)="decreaseQty(p.id)">
            <mat-icon>remove</mat-icon>
          </button>

          <span>{{ quantities[p.id] }}</span>

          <button mat-icon-button (click)="increaseQty(p.id)">
            <mat-icon>add</mat-icon>
          </button>
        </div>
      </div>

      <button mat-flat-button color="primary" class="add-btn" (click)="addToCart(p)">
        Add to Cart
      </button>
    </div>
  </div>
</div>
